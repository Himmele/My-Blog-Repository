<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0044)http://x86.ddj.com/productivity/a20reset.htm -->
<HTML><HEAD><TITLE>A20/RESET ANOMALIES</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2600.0" name=GENERATOR></HEAD>
<BODY text=#000000 vLink=#330066 aLink=#ff0000 link=#0000ff bgColor=#ffffff 
leftMargin=8 background="A20-Reset Anomalies-Dateien/back3.gif" topMargin=8 
MARGINHEIGHT="8" MARGINWIDTH="8">
<TABLE cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR><!--------------- LEFT SIDE ------------>
    <TD vAlign=top><FONT face=arial,helvetica size=-1><A 
      href="http://x86.ddj.com/"><IMG height=90 
      src="A20-Reset Anomalies-Dateien/logo_small.gif" width=115 align=top 
      border=0></A><BR clear=all><!-- Left side nav items: two-column table, bullets in left column -->
      <TABLE cellSpacing=0 cellPadding=0 width=128 border=0>
        <TBODY>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://www.ddj.com/"><IMG height=20 alt="DDJ Home" 
            src="A20-Reset Anomalies-Dateien/ddjhome.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD><IMG height=5 alt="" 
            src="A20-Reset Anomalies-Dateien/spacer.gif" width=1 align=top><BR 
            clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/news/hotnews.htm"><IMG height=40 
            alt="Today's Headlines" 
            src="A20-Reset Anomalies-Dateien/newnews.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/news/old.htm"><IMG height=20 
            alt="Past Headlines" src="A20-Reset Anomalies-Dateien/pastnews.gif" 
            width=120 border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/articles/articles.htm"><IMG 
            height=40 alt="Microprocessor Articles" 
            src="A20-Reset Anomalies-Dateien/m_articles.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/secrets/intelsecrets.htm"><IMG 
            height=20 alt="Intel Secrets" 
            src="A20-Reset Anomalies-Dateien/intel.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/errata/errataseries.htm"><IMG 
            height=20 alt="Intel Errata" 
            src="A20-Reset Anomalies-Dateien/errata.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/ddj/ddj.htm"><IMG height=40 
            alt="Undocumented Corner" src="A20-Reset Anomalies-Dateien/udoc.gif" 
            width=120 border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/intel.doc/inteldocs.htm"><IMG 
            height=40 alt="Processor Manuals" 
            src="A20-Reset Anomalies-Dateien/pmanual.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A 
            href="http://x86.ddj.com/intel.doc/intelmotherboards.htm"><IMG 
            height=40 alt="Motherboard Manuals" 
            src="A20-Reset Anomalies-Dateien/mmanual.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD vAlign=top><IMG height=20 alt="* " 
            src="A20-Reset Anomalies-Dateien/dot.gif" width=7 VALIGN="top"></TD>
          <TD><A href="http://x86.ddj.com/links.htm"><IMG height=20 alt=Links 
            src="A20-Reset Anomalies-Dateien/links.gif" width=120 
            border=0></A><BR clear=all></TD></TR>
        <TR>
          <TD><IMG height=50 alt="" 
            src="A20-Reset Anomalies-Dateien/spacer.gif" width=1 align=top><BR 
            clear=all></TD></TR>
        <TR>
          <TD align=left colSpan=2><!-- REMOTE AD CALL <%/remoteviewad?site=x86&pagepos=buttonsponsor|site=x86|pagepos=buttonsponsor%> --><A 
            href="http://newads.cmpnet.com/event.ng/Type=click&amp;ProfileID=6783&amp;RunID=38371&amp;AdID=25450&amp;GroupID=304&amp;FamilyID=2749&amp;TagValues=2901.2949&amp;Redirect=http://www.sdmagazine.com" 
            target=_top><IMG height=1 alt="" 
            src="A20-Reset Anomalies-Dateien/clear_1x1.gif" width=1 
            border=0></A> <!-- REMOTE AD CALL <%/remoteviewad?site=ddj&pagepos=buttonsponsor&uri=nav-bottom|uri=nav-bottom|site=ddj|pagepos=buttonsponsor%> --><!-- AD ERROR: No profiles found to match request (site=ddj, pagepos=buttonsponsor, server_name=, uri=)--></TD></TR></TBODY></TABLE></FONT></TD><!-- End left-hand column --><!--------------- MAIN BODY ------------>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD><!-- First row: ad --><!-- REMOTE AD CALL <%/remoteviewad?site=x86&pagepos=top|site=x86|pagepos=top%> --><A 
            href="http://newads.cmpnet.com/event.ng/Type=click&amp;ProfileID=7160&amp;RunID=39872&amp;AdID=29899&amp;GroupID=320&amp;FamilyID=1&amp;TagValues=178.2949&amp;Redirect=http:java.sun.com/javaone/" 
            target=_top><IMG height=60 alt="" 
            src="A20-Reset Anomalies-Dateien/ddj_javaone_468.gif" width=468 
            border=1></A> </TD></TR>
        <TR>
          <TD background="A20-Reset Anomalies-Dateien/dash_wide.gif"><!-- 2nd row: rule --><IMG 
            height=10 src="A20-Reset Anomalies-Dateien/spacer.gif" width=1> 
        </TD></TR>
        <TR>
          <TD><!-- 3rd row: Header --><IMG height=40 
            alt="Microprocessor Resources" 
            src="A20-Reset Anomalies-Dateien/microprocessor.gif" width=350><BR 
            clear=all><IMG height=10 
            src="D:\Eigene Dateien\OS Programming\A20-Reset Anomalies-Dateien\spacer(1).gif" 
            width=1><BR></TD></TR>
        <TR>
          <TD><!-- 4th row: Page content -->
            <H1>A20/RESET ANOMALIES</H1>
            <HR>

            <P>Since the 8088 only has 20 address lines, IBM decided to add 
            extra hardware in the AT to ensure that it would emulate the 8088 
            memory wrap "feature." They did this by ANDING the CPU A20 with an 
            output of the keyboard controller (KBC). Both signals must be active 
            before the real A20 is asserted on the bus. When the KBC was 
            programmed appropriately, it's output is always LOW. This inhibits 
            the CPU A20 from ever being asserted on the address bus. This 
            condition emulates the memory wrap that the 8088 has. When the 
            keyboard controller is programmed to allow CPU A20 on the address 
            bus, all address lines are presented without any other side effects. 
            And when programmed to inhibit A20, nobody thought there would be 
            any adverse side effects -- but there are.</P>
            <P>Since CPU A20 is the only address line gated, then any memory 
            access to extended memory on odd megabyte boundaries is inhibited 
            (1M-2M, 3M-4M, etc.). Regardless of the state of the gate, the 
            programmer always has access to every even megabyte of memory 
            (0M-1M, 2M-3M, etc.). A peculiar situation arises when CPU A20 is 
            inhibited from the address bus, and a RESET occurs. Since execution 
            begins at the top of memory (and not F000:FFF0), when CPU A20 is 
            gated off, the system will crash. Why? Consider CPU A20. The top of 
            memory is FFFFF0h on the '286 and FFFFFFF0 on the '386 and later 
            processors. If CPU A20 is gated off, then the RESET will cause 
            execution to begin at EFFFF0 on the '286 and FFEFFFF0 on the '386. 
            Unless these addresses are mapped through hardware to appear at the 
            top of memory, then the computer will crash -- as it will try and 
            execute whatever lies at these addresses (most likely a floating 
            BUS).</P>
            <P>The moral to the story? Don't ever RESET the CPU without enabling 
            CPU A20 to the address BUS. </P>
            <HR>

            <P><A 
            href="http://x86.ddj.com/productivity/productivityenhancements.htm#a20ptr">Back 
            to Productivity Enhancements</A></P></TD></TR>
        <TR>
          <TD background="A20-Reset Anomalies-Dateien/dash_wide.gif"><!-- rule --><IMG 
            height=10 src="A20-Reset Anomalies-Dateien/spacer.gif" width=1> 
        </TD></TR>
        <TR>
          <TD><!-- Bottom Advertisement -->
            <TABLE cellSpacing=0 cellPadding=1 width=490 bgColor=#cccccc 
            border=0>
              <TBODY>
              <TR>
                <TD vAlign=center align=middle><FONT face=Arial 
                  size=1>Advertisement</FONT> </TD></TR>
              <TR>
                <TD vAlign=center align=middle><!-- REMOTE AD CALL <%/remoteviewad?site=x86&pagepos=bottom|site=x86|pagepos=bottom%> --><A 
                  href="http://newads.cmpnet.com/event.ng/Type=click&amp;ProfileID=7167&amp;RunID=39872&amp;AdID=29899&amp;GroupID=320&amp;FamilyID=1&amp;TagValues=179.2949&amp;Redirect=http:java.sun.com/javaone/" 
                  target=_top><IMG height=60 alt="" 
                  src="A20-Reset Anomalies-Dateien/ddj_javaone_468.gif" 
                  width=468 border=1></A> </TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><!-- Copyright message --><FONT face="Arial, Helvetica" 
            size=-1>Copyright © 2002 <I>Dr. Dobb's 
        Journal<BR></I></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></BODY></HTML>
